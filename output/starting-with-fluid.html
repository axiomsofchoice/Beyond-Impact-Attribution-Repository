<html>
  <head>
    <style type="text/css">
      .hll { background-color: #ffffcc }
      .c { color: #888888 } /* Comment */
      .err { color: #a61717; background-color: #e3d2d2 } /* Error */
      .k { color: #008800; font-weight: bold } /* Keyword */
      .cm { color: #888888 } /* Comment.Multiline */
      .cp { color: #cc0000; font-weight: bold } /* Comment.Preproc */
      .c1 { color: #888888 } /* Comment.Single */
      .cs { color: #cc0000; font-weight: bold; background-color: #fff0f0 } /* Comment.Special */
      .gd { color: #000000; background-color: #ffdddd } /* Generic.Deleted */
      .ge { font-style: italic } /* Generic.Emph */
      .gr { color: #aa0000 } /* Generic.Error */
      .gh { color: #303030 } /* Generic.Heading */
      .gi { color: #000000; background-color: #ddffdd } /* Generic.Inserted */
      .go { color: #888888 } /* Generic.Output */
      .gp { color: #555555 } /* Generic.Prompt */
      .gs { font-weight: bold } /* Generic.Strong */
      .gu { color: #606060 } /* Generic.Subheading */
      .gt { color: #aa0000 } /* Generic.Traceback */
      .kc { color: #008800; font-weight: bold } /* Keyword.Constant */
      .kd { color: #008800; font-weight: bold } /* Keyword.Declaration */
      .kn { color: #008800; font-weight: bold } /* Keyword.Namespace */
      .kp { color: #008800 } /* Keyword.Pseudo */
      .kr { color: #008800; font-weight: bold } /* Keyword.Reserved */
      .kt { color: #888888; font-weight: bold } /* Keyword.Type */
      .m { color: #0000DD; font-weight: bold } /* Literal.Number */
      .s { color: #dd2200; background-color: #fff0f0 } /* Literal.String */
      .na { color: #336699 } /* Name.Attribute */
      .nb { color: #003388 } /* Name.Builtin */
      .nc { color: #bb0066; font-weight: bold } /* Name.Class */
      .no { color: #003366; font-weight: bold } /* Name.Constant */
      .nd { color: #555555 } /* Name.Decorator */
      .ne { color: #bb0066; font-weight: bold } /* Name.Exception */
      .nf { color: #0066bb; font-weight: bold } /* Name.Function */
      .nl { color: #336699; font-style: italic } /* Name.Label */
      .nn { color: #bb0066; font-weight: bold } /* Name.Namespace */
      .py { color: #336699; font-weight: bold } /* Name.Property */
      .nt { color: #bb0066; font-weight: bold } /* Name.Tag */
      .nv { color: #336699 } /* Name.Variable */
      .ow { color: #008800 } /* Operator.Word */
      .w { color: #bbbbbb } /* Text.Whitespace */
      .mf { color: #0000DD; font-weight: bold } /* Literal.Number.Float */
      .mh { color: #0000DD; font-weight: bold } /* Literal.Number.Hex */
      .mi { color: #0000DD; font-weight: bold } /* Literal.Number.Integer */
      .mo { color: #0000DD; font-weight: bold } /* Literal.Number.Oct */
      .sb { color: #dd2200; background-color: #fff0f0 } /* Literal.String.Backtick */
      .sc { color: #dd2200; background-color: #fff0f0 } /* Literal.String.Char */
      .sd { color: #dd2200; background-color: #fff0f0 } /* Literal.String.Doc */
      .s2 { color: #dd2200; background-color: #fff0f0 } /* Literal.String.Double */
      .se { color: #0044dd; background-color: #fff0f0 } /* Literal.String.Escape */
      .sh { color: #dd2200; background-color: #fff0f0 } /* Literal.String.Heredoc */
      .si { color: #3333bb; background-color: #fff0f0 } /* Literal.String.Interpol */
      .sx { color: #22bb22; background-color: #f0fff0 } /* Literal.String.Other */
      .sr { color: #008800; background-color: #fff0ff } /* Literal.String.Regex */
      .s1 { color: #dd2200; background-color: #fff0f0 } /* Literal.String.Single */
      .ss { color: #aa6600; background-color: #fff0f0 } /* Literal.String.Symbol */
      .bp { color: #003388 } /* Name.Builtin.Pseudo */
      .vc { color: #336699 } /* Name.Variable.Class */
      .vg { color: #dd7700 } /* Name.Variable.Global */
      .vi { color: #3333bb } /* Name.Variable.Instance */
      .il { color: #0000DD; font-weight: bold } /* Literal.Number.Integer.Long */
    </style>
  </head>
  <body>

<p>This is a script to run our demo in fluid.</p>
<div class="highlight"><pre><a name="l-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">fluidinfo</span>
<a name="l-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">json</span>
<a name="l-3"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">os</span>
<a name="l-4"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">urllib</span>
<a name="l-5"></a><span class="gp">&gt;&gt;&gt; </span>
</pre></div>

<p>We log in with a username/password from the env:</p>
<div class="highlight"><pre><a name="l-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">USERNAME</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s">&quot;FLUID_USERNAME&quot;</span><span class="p">]</span>
<a name="l-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">PASSWORD</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s">&quot;FLUID_PASSWORD&quot;</span><span class="p">]</span>
<a name="l-3"></a><span class="gp">&gt;&gt;&gt; </span>
<a name="l-4"></a><span class="gp">&gt;&gt;&gt; </span><span class="k">if</span> <span class="ow">not</span> <span class="n">USERNAME</span><span class="p">:</span>
<a name="l-5"></a><span class="gp">... </span>    <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s">&quot;Please supply a fluid account username&quot;</span><span class="p">)</span>
<a name="l-6"></a><span class="gp">... </span>
<a name="l-7"></a><span class="gp">&gt;&gt;&gt; </span><span class="k">if</span> <span class="ow">not</span> <span class="n">PASSWORD</span><span class="p">:</span>
<a name="l-8"></a><span class="gp">... </span>    <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s">&quot;Please supply a fluid account password&quot;</span><span class="p">)</span>
<a name="l-9"></a><span class="gp">... </span>
<a name="l-10"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">fluidinfo</span><span class="o">.</span><span class="n">login</span><span class="p">(</span><span class="n">USERNAME</span><span class="p">,</span> <span class="n">PASSWORD</span><span class="p">)</span>
<a name="l-11"></a><span class="gp">&gt;&gt;&gt; </span>
<a name="l-12"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">headers</span><span class="p">,</span> <span class="n">response</span> <span class="o">=</span> <span class="n">fluidinfo</span><span class="o">.</span><span class="n">call</span><span class="p">(</span><span class="s">&#39;GET&#39;</span><span class="p">,</span> <span class="s">&quot;/users/</span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="n">USERNAME</span><span class="p">)</span>
<a name="l-13"></a><span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">response</span>
<a name="l-14"></a><span class="go">{&#39;name&#39;: &#39;Ana Nelson&#39;, &#39;id&#39;: &#39;19de8e88-a494-45dc-bc50-bd51bf435263&#39;}</span>
<a name="l-15"></a><span class="gp">&gt;&gt;&gt; </span>
</pre></div>

<p>Now we will consider how to create bibliographic entries.</p>
<p>In Fluid, you can create objects via a unique name, or you can create an unnamed objects. In either case, Fluid will return the identifier for the item. If you create an object by name and this name already exists, the existing identifier is returned.</p>
<p>Here is a named object:
<div class="highlight"><pre><a name="l-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">headers</span><span class="p">,</span> <span class="n">response</span> <span class="o">=</span> <span class="n">fluidinfo</span><span class="o">.</span><span class="n">call</span><span class="p">(</span><span class="s">&#39;POST&#39;</span><span class="p">,</span> <span class="s">&quot;/about/mybook&quot;</span><span class="p">)</span>
<a name="l-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="s">&quot;headers from creating named object:&quot;</span>
<a name="l-3"></a><span class="go">headers from creating named object:</span>
<a name="l-4"></a><span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">headers</span>
<a name="l-5"></a><span class="go">{&#39;status&#39;: &#39;201&#39;, &#39;content-length&#39;: &#39;131&#39;, &#39;server&#39;: &#39;nginx/0.7.65&#39;, &#39;connection&#39;: &#39;keep-alive&#39;, &#39;location&#39;: &#39;https://fluiddb.fluidinfo.com/objects/9f02db51-4300-4868-91f7-100f746de682&#39;, &#39;cache-control&#39;: &#39;no-cache&#39;, &#39;date&#39;: &#39;Tue, 10 May 2011 16:16:20 GMT&#39;, &#39;content-type&#39;: &#39;application/json&#39;}</span>
<a name="l-6"></a><span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="s">&quot;response from creating named object:&quot;</span>
<a name="l-7"></a><span class="go">response from creating named object:</span>
<a name="l-8"></a><span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">response</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<a name="l-9"></a><span class="gp">... </span>    <span class="k">print</span> <span class="n">k</span><span class="p">,</span> <span class="s">&quot;:&quot;</span><span class="p">,</span> <span class="n">v</span>
<a name="l-10"></a><span class="gp">... </span>
<a name="l-11"></a><span class="go">id : 9f02db51-4300-4868-91f7-100f746de682</span>
<a name="l-12"></a><span class="go">URI : https://fluiddb.fluidinfo.com/objects/9f02db51-4300-4868-91f7-100f746de682</span>
</pre></div></p>
<p>Here is an anonymous object:
<div class="highlight"><pre><a name="l-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="c">#headers, response = fluidinfo.call(&#39;POST&#39;, &#39;/objects/&#39;)</span>
<a name="l-2"></a><span class="gp">... </span><span class="k">print</span> <span class="s">&quot;headers from creating anonymous object:&quot;</span>
<a name="l-3"></a><span class="go">headers from creating anonymous object:</span>
<a name="l-4"></a><span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">headers</span>
<a name="l-5"></a><span class="go">{&#39;status&#39;: &#39;201&#39;, &#39;content-length&#39;: &#39;131&#39;, &#39;server&#39;: &#39;nginx/0.7.65&#39;, &#39;connection&#39;: &#39;keep-alive&#39;, &#39;location&#39;: &#39;https://fluiddb.fluidinfo.com/objects/9f02db51-4300-4868-91f7-100f746de682&#39;, &#39;cache-control&#39;: &#39;no-cache&#39;, &#39;date&#39;: &#39;Tue, 10 May 2011 16:16:20 GMT&#39;, &#39;content-type&#39;: &#39;application/json&#39;}</span>
<a name="l-6"></a><span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="s">&quot;response from creating anonymous object:&quot;</span>
<a name="l-7"></a><span class="go">response from creating anonymous object:</span>
<a name="l-8"></a><span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">response</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<a name="l-9"></a><span class="gp">... </span>    <span class="k">print</span> <span class="n">k</span><span class="p">,</span> <span class="s">&quot;:&quot;</span><span class="p">,</span> <span class="n">v</span>
<a name="l-10"></a><span class="gp">... </span>
<a name="l-11"></a><span class="go">id : 9f02db51-4300-4868-91f7-100f746de682</span>
<a name="l-12"></a><span class="go">URI : https://fluiddb.fluidinfo.com/objects/9f02db51-4300-4868-91f7-100f746de682</span>
<a name="l-13"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">obj_id</span> <span class="o">=</span> <span class="n">response</span><span class="p">[</span><span class="s">&#39;id&#39;</span><span class="p">]</span>
<a name="l-14"></a><span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">obj_id</span>
<a name="l-15"></a><span class="go">9f02db51-4300-4868-91f7-100f746de682</span>
<a name="l-16"></a><span class="gp">&gt;&gt;&gt; </span>
</pre></div></p>
<p>However, for the goals of this project, the anonymous object makes more sense. While it is tempting to use DOIs as a name, this is problematic as you may not know a DOI when you are creating an object, and some formats of DOI are not suitable as fluidinfo names (even with url escaping). So it is more appropriate to use anonymous objects and set the DOI (if we have one) as a tag.</p>
<h2>Namespace</h2>
<p>We want to create a project namespace, we will assume that the user ianmulvany is creating this:</p>
<div class="highlight"><pre><a name="l-1"></a><span class="n">parent_namespace</span> <span class="o">=</span> <span class="s">&#39;/namespaces/ianmulvany&#39;</span>
<a name="l-2"></a><span class="n">namespace_info</span> <span class="o">=</span> <span class="p">{</span>
<a name="l-3"></a>    <span class="s">&#39;name&#39;</span><span class="p">:</span> <span class="s">&#39;biar&#39;</span><span class="p">,</span>
<a name="l-4"></a>    <span class="s">&#39;description&#39;</span><span class="p">:</span> <span class="s">&#39;beyond impact attribution registry namespace&#39;</span>
<a name="l-5"></a><span class="p">}</span>
<a name="l-6"></a><span class="n">fluidinfo</span><span class="o">.</span><span class="n">call</span><span class="p">(</span><span class="s">&#39;POST&#39;</span><span class="p">,</span> <span class="n">parent_namespace</span><span class="p">,</span> <span class="n">namespace_info</span><span class="p">)</span>
</pre></div>

<p>After creating the namespace, we set permissions:</p>
<div class="highlight"><pre><a name="l-1"></a><span class="n">permission_space</span> <span class="o">=</span> <span class="s">&#39;/permissions/namespaces/ianmulvany/biar&#39;</span>
<a name="l-2"></a><span class="n">permission_info</span> <span class="o">=</span> <span class="p">{</span>
<a name="l-3"></a>    <span class="s">&#39;policy&#39;</span><span class="p">:</span> <span class="s">&#39;open&#39;</span><span class="p">,</span>
<a name="l-4"></a>    <span class="s">&#39;exceptions&#39;</span><span class="p">:</span> <span class="p">[]</span>
<a name="l-5"></a><span class="p">}</span>
<a name="l-6"></a><span class="n">fluidinfo</span><span class="o">.</span><span class="n">call</span><span class="p">(</span><span class="s">&#39;PUT&#39;</span><span class="p">,</span> <span class="n">permission_space</span><span class="p">,</span> <span class="n">permission_info</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s">&quot;create&quot;</span><span class="p">)</span>
</pre></div>
  </body>
</html>

